"use strict";!function(t,e){"function"==typeof define?define(["jQuery"],function(t){e(t)}):e(t)}(jQuery,function(K){K.fn.jcDate=function(J){var t={Class:"",Default:"today",Event:"click",Speed:100,Left:0,Top:K("input.jcDate")[0].getBoundingClientRect().height,Format:"-",DoubleNum:!0,Timeout:100,OnChange:function(){}};return J=K.extend(t,J),K(this).each(function(t,e){0==K("#jcDate").length&&K("body").prepend("<div id='jcDate'><input type='hidden' value='' id='dateHideText' /><div id='jcDateTt'><a id='d_prev'>&#9668;</a><div><span></span><b>年</b><samp></samp><b>月</b></div><a id='d_next'>&#9658;</a></div><dl id='jcYeas'></dl><dl id='jcMonth'></dl><div id='jcDayWrap'><dl id='jcDayCon'></dl><div id='jcDateMax'><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul></div><div id='jcDateBtn'><samp>今天</samp><span>清空</span><a id='d_sub'>确定</a><div id='jcTimeWrap'><input type='text' value='' /><label>:</label><input type='text' value='' /></div></div></div></div>");var i,a,n,d=K(e),l=(K(window),new Date),o=K("#jcDate"),s=K("#jcDateTt"),p=(K(this).offset().left,K(this).offset().top,s.find("span")),u=s.find("samp"),f=s.find("b"),c=K("#jcDateMax"),r=K("#jcDayCon"),v=K("#jcDateBtn"),h=K("#jcYeas"),m=K("#jcMonth"),j=v.find("samp"),D=v.find("span"),C=K("#jcDayWrap"),x=C.find("ul"),g=v.find("a#d_sub"),b=K("input#dateHideText"),e=K("#jcTimeWrap"),y=e.find("input:eq(0)"),w=e.find("input:eq(1)"),s=K("#d_prev"),v=K("#d_next"),k=parseInt(l.getFullYear()),T=l.getMonth()+1,V=l.getDate(),_=["日","一 ","二 ","三 ","四 ","五 ","六 "],F=(l.getDay(),l.getHours(),l.getMinutes(),""),e="<dd class='visited'>"+k+"年</dd>",q="",I=0,M=function(t,e){return[31,t%4==0&&t%100!=0||t%400==0?29:28,31,30,31,30,31,31,30,31,30,31][e+1]},O=k,Y=[],S=[];function W(t){var e="";for(a in t)e+=t[a];return e}function B(t,e,i,a,n){var d=J.speed;e.fadeOut(d),i.fadeOut(d),t.delay(2*d).fadeIn(d),a?(K("#d_prev,#d_next").fadeOut(d),f.eq(n).hide()):(K("#d_prev,#d_next").fadeIn(d),f.show(),p.show(),u.show())}function H(t){p.text(t);for(var e=0;e<x.length;e++){for(var i,a,n,d="",l="",o="",s="",u=new Date(t,e,1).getDay(),f=null==M(t,e-2)?31:M(t,e-2),c=1;c<=M(t,e-1);c++)d=d+"<li class='jcDateColor'>"+c+"</li>";for(var r=0;r<u;r++)s+="<li>"+f+"</li>,",f--;for(var v=0;v<=42-(c+u);v++)o+="<li>"+(v+1)+"</li>";for(n in i=s.split(",").reverse())l+=i[n];a=l+d+o,x.eq(e).html(a)}}function E(t){x.eq(t).addClass("dateV").siblings().removeClass("dateV"),u.text(t+1),c.animate({left:161*-t},J.Speed)}function L(t,e,i){p.text(t),u.text(e),H(t),K.each(x.eq(e-1).find("li"),function(){K(this).hasClass("jcDateColor")&&x.eq(e-1).find("li.jcDateColor").eq(i-1).addClass("visited")}),b.val(V),x.eq(e-1).find("li").text(),E(e-1)}function N(t){t=t.split(J.Format);return J.DoubleNum&&(t[1]=1===t[1].length?"0"+t[1]:t[1],t[2]=1===t[2].length?"0"+t[2]:t[2]),t.join(J.Format)}function Q(){var t=p.text(),e=u.text(),i=[t,e,b.val()],a=i.join(J.Format);"00"==y.val()&&"00"==w.val()||(t=y.val(),e=w.val(),i.push(t+":"+e),a=(i=i.join(J.Format).substring().split("/"))[0]+J.Format+i[1]+J.Format+i[2]+" "+i[3]),K("input.dateVisited").val(N(a)),R(),J.OnChange()}function R(){K("input.dateVisited").removeClass("dateVisited"),o.hide(J.Speed)}for(i in y.val("00"),w.val("00"),"today"===J.Default?d.val(N([k,T,V].join(J.Format))):d.val(N(J.Default)),_)F=F+"<dt>"+_[i]+"</dt>";r.html(F);for(var z=0;z<9;z++)Y.push("<dt>"+(O-(z+1))+"年</dt>");Y.reverse();for(var l=W(Y),A=Y.length=0;A<8;A++)Y.push("<dt>"+(O+(A+1))+"年</dt>");r=W(Y),h.html(l+e+r);for(var G=1;G<=12;G++)G==T?S.push("<dt class='visited'>"+G+"月</dt>"):S.push("<dt>"+G+"月</dt>");for(n in S)q+=S[n];m.html(q),p.off().on("click",function(){K(this).addClass("visited").next("samp").removeClass("visited"),B(h,C,m,!0,1),p.show(),u.hide()}),K("#jcYeas dd,#jcYeas dt").off().on("click",function(){var t=parseInt(K(this).text());H(t),p.text(t),B(C,h,m,!1)}),u.off().on("click",function(){K(this).addClass("visited").prev().removeClass("visited"),B(m,C,h,!0,0),u.show(),p.hide()}),m.find("dt").off().on("click",function(){var t=parseInt(K(this).text());E(t-1),u.text(t),B(C,h,m,!1)}),E(T-1),s.off().on("click",function(){var t;0<(I=x.filter(".dateV").index())?I--:(t=parseInt(p.text()),H(--t),I=x.length-1),E(I)}),v.off().on("click",function(){var t;(I=x.filter(".dateV").index())<x.length-1?I++:(t=parseInt(p.text()),H(++t),I=0),E(I)}),L(k,T,V),x.undelegate("li.jcDateColor","click").delegate("li.jcDateColor","click",function(){K.each(K("li.jcDateColor",x),function(){K(this).hasClass("visited")&&K(this).removeClass("visited")}),K(this).addClass("visited"),b.val(parseInt(K(this).text()))}),x.undelegate("li.jcDateColor","dblclick").delegate("li.jcDateColor","click",function(){Q()}),j.off().on("click",function(){L(k,T,V)}),D.off().on("click",function(){K("input.dateVisited").val("")}),g.off().on("click",function(){Q()}),d.addClass(J.Class).off().on(J.Event,function(t){var e=K(this).val();e&&L((i=e.split(J.Format))[0],i[1],i[2]),K("input.dateVisited").length&&K("input.dateVisited").removeClass("dateVisited"),K(this).addClass("dateVisited");var i=K(this).offset();o.css({left:i.left+J.Left,top:i.top+J.Top}),o.show(J.Speed),C.show(),h.hide(),m.hide(),K("#d_prev,#d_next").show(),p.show(),u.show(),f.show()}),d.off("mouseleave").on("mouseleave",function(){d.off("blur")}),d.off("blur").on("blur",function(){setTimeout(R,J.Timeout)}),o.off().on("mouseleave",function(){setTimeout(R,J.Timeout)})})}});